<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

<title>Your rideShare homepage </title>
<script type="text/javascript" src="/media/jquery.js"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

<script type="text/javascript">

  var directionDisplay;
  var directionsService = new google.maps.DirectionsService();
  var map;

  function initialize() {

       directionsDisplay = new google.maps.DirectionsRenderer();
       var myOptions = {

           zoom:7,
           mapTypeId: google.maps.MapTypeId.ROADMAP,
       }
       map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

      directionsDisplay.setMap(map);
}

function calcRoute(){

  var start = document.getElementById('id_startAddress').value + "," + document.getElementById('id_startZip').value
  var end = document.getElementById('id_endAddress').value + "," + document.getElementById('id_endZip').value

 var request = {
     origin:start,
     destination:end,
     travelMode: google.maps.DirectionsTravelMode.DRIVING
     };

 directionsService.route(request, function(response, status) {

     if (status == google.maps.DirectionsStatus.OK) {

          directionsDisplay.setDirections(response);
          showSteps(response);
}     

});

}

function showSteps(directionResult)
{
  var myRoute = directionResult.routes[0].legs[0];

      alert( myRoute.distance.text);
      alert( myRoute.duration.text);
      alert( myRoute.start_address);
      alert( myRoute.end_address);

	 var dataString = 'id_startAddress=' + myRoute.start_address + '&id_endAddress=' + myRoute.end_address;
		
		alert (dataString);

			ajax({
	      type: "POST",
	      url: "/rides/home/",
	      data: dataString,
	      success: function() {
	        alert("woohoo");
	      }
	     });
	
	    return false;
	


}







</script>
</head>
<body onload="initialize()">

<h1>Rides coming up..</h1>
{% if rides %}

     {% for ride in rides %}

       Heading To:   {{ ride.trip }} <a href="/rides/remove/{{ride.id}}"> Remove </a><br>

     {% endfor %}

{% else %}

     You don't have any rides

{% endif %}

<br><br><br><br>
<h1>Available Rides </h1>
{% if availableRides %}

     {% for ride in availableRides %}

        Ride To : {{ ride.trip }} <a href="/rides/add/{{ride.id}}"> Add </a> <br>

     {% endfor %}


{% else %}

     There aren't any rides available

{% endif %}


<h1>Create a Trip</h1>

<form>
{% csrf_token %}
{{ form.as_p }}
<input type="button" value="Submit" onClick="calcRoute()"/>
</form>

<div id="map_canvas" style="width:500px; height:300px"></div>

</body>
</html>
